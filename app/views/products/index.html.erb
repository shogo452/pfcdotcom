<%= render "layouts/header" %>
<% unless user_signed_in? %>
  <div class="jumbotron jumbotron-fluid welcome-header">
  <div class="container-fluid">
    <div class="row">
      <div class="col d-none d-sm-block">
        <div class="welcome-header__logo d-none d-sm-block">
          <%= image_tag "logo_transparent.png", size: "300x300" %>
        </div>
      </div>
      <div class="col">
        <h1 class="display-4 welcome-header__title title">Welcome to PFC.com !!</h1>
        <p class="lead welcome-header__message">
          PFC.comは筋トレやダイエットに取り組むユーザーに向けた<br/>高タンパク質、低糖質の商品情報をシェアできるサービスです。<br/>
          タンパク質（Protein）、脂質（Fat）、炭水化物（Carbo）、糖質（Sugar）の<br/>4つの栄養素量をシェアしましょう！
        </p>
        <p class="text-light">すぐに全機能をお試しになりたい場合は、ゲストユーザーとしてログインできます。</p>
        <%= form_for User.new, url: user_session_path, html: {class: "test-user-login"} do |f| %>
          <%= f.hidden_field :email, value: "test@example.com" %>
          <%= f.hidden_field :password, value: "testtest" %>
          <%= f.submit "ゲストユーザーでログイン", class: "btn btn-primary btn-sm mr-2" %>
        <% end %>
      </div>
      <small class="reference-link">Designed by <a href="https://jp.freepik.com/free-photos-vectors/background">Freepik</a></small>
    </div>
  </div>
</div>
<% end %>

<div class="container pb-3">
<div class="row">
  <div class="col-8">
    <%= fa_icon "tags" %>
    <h5 class="tag_list__title">タグ一覧</h5>
    <div class="tag_list__content">
      <% @tags.each do |tag| %>
        <span class="badge badge-info">
          <%= link_to tag.name, tag_index_products_path(tag_name: tag.name), class: "text-white" %> 
          <%= "(#{tag.taggings_count})"%>
        </span>
      <% end %>
    </div>
  </div>
  <div class="col-4">
    検索欄
  </div>
</div>
</div>

<div class="container pb-3">
<div class="row justify-content-around">
<div class="col">
    <%= fa_icon "crown" %>
    <h5 class="ranking__title">いいねランキング</h5>
      <table class="table table-sm my-2">
        <thead class="thead-dark">
          <tr>
            <th scope="col">順位</th>
            <th scope="col">名前</th>
            <th scope="col">いいね数</th>
          </tr>
        </thead>
        <tbody>
            <tr>
              <th scope="row">1</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
            <tr>
              <th scope="row">2</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
            <tr>
              <th scope="row">3</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
            <tr>
              <th scope="row">4</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
            <tr>
              <th scope="row">5</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
        </tbody>
      </table>
</div>
<div class="col">
    <%= fa_icon "heart" %>
    <h5 class="ranking__title">お気に入りランキング</h5>

      <table class="table table-sm my-2">
        <thead class="thead-dark">
          <tr>
            <th scope="col">順位</th>
            <th scope="col">名前</th>
            <th scope="col">お気に入り数</th>
          </tr>
        </thead>
        <tbody>
            <tr>
              <th scope="row">1</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
            <tr>
              <th scope="row">2</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
              <th scope="row">3</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
              <th scope="row">4</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
              <th scope="row">5</th>
              <td>aaaaa</td>
              <td>20</td>
            </tr>
        </tbody>
      </table>
  </div>
</div>
</div>

    <div class="container">
      <div class="d-flex flex-wrap justify-content-around">

      <% @products.each do |product| %>
        <div class="card border-0 pb-1", style="width: 500px;" >
          <div class="row no-gutters">
            <div class="col">
              <% if product.image_url %>
                <%= link_to product_path(product), method: :get do %>
                  <%= image_tag product.image_url, class: "card-img mx-auto d-block product__photo", alt: "aaa" %>
                <% end %>
              <% else %>
                <%= link_to product_path(product), method: :get do %>
                  <%= image_tag "noimage.jpg", class: "card-img mx-auto d-block product__photo", alt: "aaa" %>
                <% end %>
              <% end %>
              <div class="product__date">
                <p class="card-text"><i class="far fa-calendar pr-2"></i><small class="text-muted"><%= product.created_at.to_s(:date) %></small></p>
              </div>
              <div class="product__response-list">
                <div class="product__response-list__item">
                  <%= fa_icon "thumbs-up" %>
                  <small class=>12</small>
                </div>
                <div class="product__response-list__item">
                  <%= fa_icon "heart" %>
                  <small class=>12</small>
                </div>
              </div>
              <div class="d-block text-center my-1">
                <button type="button" class="btn btn-primary btn-sm mb-1 border-0 mx-auto", style="background: #55ACEE;">
                  <%= fa_icon "twitter" %>
                    Twitterでシェア
                </button>
              </div>
              <div class="d-block text-center mb-1">
                <div class="btn-group btn-group-sm mx-auto" role="group" aria-label="Basic example">
                  <button type="button" class="btn btn-secondary">
                    <%= fa_icon "shopping-cart" %>
                  </button>
                  <% if user_signed_in? && product.user.id == current_user.id %>
                    <%= link_to "/products/#{product.id}/edit", class: "btn btn-secondary", method: :get do %>
                      <%= fa_icon "edit" %>
                    <% end %>
                    <%= link_to "/products/#{product.id}", class: "btn btn-secondary", method: :delete, data: { confirm: "商品を削除します。よろしいですか?"} do %>
                      <%= fa_icon "trash"%>
                    <% end %>
                  <% end %>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card-body">
                <h5 class="card-title text-truncate">
                <%= product.name %>
                </h5></br>
                <div id="star-rate-#{product.review.id}"></div>
                <div class="review-rating" data-score="<%= @rates[product.id] %>"></div>
                <% if product.new_arrival? %>
                  <span class="badge badge-secondary ml-1">New</span><br/>
                <% end %>
                <div class="row">
                  <div class="col">
                    <span class="card-text">たんぱく質</span><br/>
                  <% if product.protein? %>
                    <strong class="h4 pl-2"><%= product.protein.to_f %></strong> g<br/>
                  <% end %>
                    <span class="card-text">脂質</span><br/>
                  <% if product.fat? %>
                    <strong class="h4 pl-2"><%= product.fat.to_f %></strong> g<br/>
                  <% end %>
                  </div>
                  <div class="col">
                    <span class="card-text">炭水化物</span><br/>
                  <% if product.carbo? %>
                    <strong class="h4 pl-2"><%= product.carbo.to_f %></strong> g<br/>
                  <% end %>
                    <span class="card-text">糖質</span><br/>
                  <% if product.sugar? %>
                    <strong class="h4 pl-2"><%= product.sugar.to_f %></strong> g<br/>
                  <% else %>
                    <strong class="h4 pl-2"> - </strong> g<br/>
                  <% end %>
                  </div>
                </div>
                <div class="row">
                  <div class="col">
                    <span class="card-text">価格</span><br/>
                    <% if product.price? %>
                      <strong class="h4 pl-2"><%= product.price %></strong> 円<br/>
                    <% else %>
                      <strong class="h4 pl-2"> - </strong> 円<br/>
                    <% end %>
                  </div>
                  <div class="col">
                  </div>
                </div>
                <%= render "tag_list", tag_list: product.tag_list %><br/>
              </div>
            </div>
          </div>
        </div>
      <% end %>

      </div>
    </div>



<%= render "layouts/footer" %>

<script>
  $('.review-rating').raty({
    readOnly: true,
    score: function() {
      return $(this).attr('data-score');
    },
    path: '/assets/'
  });
</script>